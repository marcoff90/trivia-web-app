{"version":3,"file":"authorization-middleware.js","names":["authorizationMiddleware","req","res","next","token","headers","ApiError","unauthorized","split","user","jwt","verify","process","env","ACCESS_TOKEN_SECRET","ex","badRequest"],"sources":["../../src/middlewares/authorization-middleware.js"],"sourcesContent":["import jwt from 'jsonwebtoken';\nimport 'dotenv/config';\nimport ApiError from \"../error/api-error\";\n\nconst authorizationMiddleware = (req, res, next) => {\n\n  let token = req.headers[\"authorization\"];\n\n  if (!token) {\n    next(ApiError.unauthorized('Access denied! No token provided!'));\n  } else {\n    token = token.split(' ')[1];\n  }\n\n  try {\n    req.user = jwt.verify(token, process.env.ACCESS_TOKEN_SECRET);\n    next();\n\n  } catch (ex) {\n    next(ApiError.badRequest('Invalid token!'));\n  }\n};\n\nexport default authorizationMiddleware;\n"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AAEA,IAAMA,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;EAElD,IAAIC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAY,eAAZ,CAAZ;;EAEA,IAAI,CAACD,KAAL,EAAY;IACVD,IAAI,CAACG,qBAASC,YAAT,CAAsB,mCAAtB,CAAD,CAAJ;EACD,CAFD,MAEO;IACLH,KAAK,GAAGA,KAAK,CAACI,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAR;EACD;;EAED,IAAI;IACFP,GAAG,CAACQ,IAAJ,GAAWC,yBAAIC,MAAJ,CAAWP,KAAX,EAAkBQ,OAAO,CAACC,GAAR,CAAYC,mBAA9B,CAAX;IACAX,IAAI;EAEL,CAJD,CAIE,OAAOY,EAAP,EAAW;IACXZ,IAAI,CAACG,qBAASU,UAAT,CAAoB,gBAApB,CAAD,CAAJ;EACD;AACF,CAjBD;;eAmBehB,uB"}